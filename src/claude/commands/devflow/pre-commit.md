---
description: Review uncommitted changes before committing using specialized sub-agents
allowed-tools: Task, Bash, Read, Write, Grep, Glob
---

## Your Task

Perform a comprehensive review of uncommitted changes by orchestrating multiple specialized sub-agents in parallel. This provides quick feedback before committing changes.

### Step 1: Analyze Current Changes

First, check what changes are available for review:

```bash
# Check for uncommitted changes
git status --porcelain

# Get the diff of uncommitted changes
if git diff --quiet HEAD; then
    echo "No uncommitted changes to review"
    exit 0
fi

# Show summary of changes
echo "=== CHANGES TO REVIEW ==="
git diff --stat HEAD
echo ""
```

### Step 2: Launch Specialized Sub-Agents in Parallel

Launch these sub-agents in parallel:

1. audit-security sub-agent
2. audit-performance sub-agent
3. audit-architecture sub-agent
4. audit-tests sub-agent
5. audit-complexity sub-agent

### Step 3: Synthesize Review Findings

After all sub-agents complete their analysis:

1. **Collect Results**: Gather findings from all sub-agents
2. **Prioritize Issues**: Categorize as Critical/High/Medium/Low
3. **Create Unified Review**: Synthesize into coherent review document
4. **Generate Action Items**: Provide specific next steps

### Step 4: Save Review Document

Create a comprehensive review document at `.docs/reviews/diff-{YYYY-MM-DD_HHMM}.md`:

```markdown
# Code Review - Uncommitted Changes
**Date**: {current_date}
**Time**: {current_time}
**Type**: Differential Review (uncommitted changes)
**Reviewer**: AI Sub-Agent Orchestra

---

## 📊 Review Summary

**Files Changed**: {number}
**Lines Added**: {number}
**Lines Removed**: {number}

### Issues Found
- 🔴 **Critical**: {count} issues requiring immediate attention
- 🟠 **High**: {count} issues should be addressed before commit
- 🟡 **Medium**: {count} improvements recommended
- 🔵 **Low**: {count} minor suggestions

---

## 🔍 Detailed Analysis

### Security Review (audit-security)
{security findings with file:line references}

### Performance Review (audit-performance)
{performance findings with specific optimizations}

### Architecture Review (audit-architecture)
{design pattern and structure analysis}

### Test Coverage Review (audit-tests)
{test gaps and quality assessment}

### Complexity Review (audit-complexity)
{maintainability and refactoring suggestions}

---

## 🎯 Action Items

### Before Committing (Critical/High)
- [ ] {action 1} in {file:line}
- [ ] {action 2} in {file:line}

### Future Improvements (Medium/Low)
- [ ] {improvement 1}
- [ ] {improvement 2}

---

## 📈 Code Quality Metrics

**Overall Assessment**: {Excellent/Good/Needs Work/Poor}
**Commit Recommendation**: {✅ Safe to commit / ⚠️ Address issues first / 🚫 Do not commit}

---

*Review generated by DevFlow sub-agent orchestration*
```

### Step 5: Provide Interactive Summary

Give the developer a clear summary and next steps:

```
🔍 UNCOMMITTED CHANGES REVIEW COMPLETE

Changes analyzed: {X} files, {Y} lines modified
Issues found: {Critical} critical, {High} high, {Medium} medium, {Low} low

📋 COMMIT READINESS ASSESSMENT:
{✅ SAFE TO COMMIT | ⚠️ ISSUES TO ADDRESS | 🚫 DO NOT COMMIT}

🎯 TOP PRIORITY ACTIONS:
1. {Most critical issue and fix}
2. {Second most critical issue and fix}
3. {Third most critical issue and fix}

📄 Full review saved to: .docs/reviews/diff-{timestamp}.md

💡 TIP: Run `/review-branch` before creating PR for comprehensive feature review
```
